group 'hoverfly-test'
version '1.0-SNAPSHOT'

apply plugin: 'groovy'
apply plugin: 'java'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    compile 'org.codehaus.groovy:groovy-all:2.3.11'
    compile "io.specto:hoverfly-java:0.8.1"
    compile group: 'org.gebish', name: 'geb-core', version: "1.1.1"
    compile group: 'org.seleniumhq.selenium', name: 'selenium-firefox-driver', version: "3.4.0"
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

test {
    systemProperties = [
            hoverfly: System.getProperty('test.hoverfly', 'false')
    ]
}

task checkGeckoDriverFile() {
    if (! file('./src/main/resources/').list().contains("geckodriver") && ! file('./src/main/resources/').list().contains("geckodriver.exe")) {
        throw new GradleException('See README. You must download the version of the Firefox driver called geckodriver for your particular operating system and save in ./src/main/resources')
    }
}

project.tasks.test.dependsOn checkGeckoDriverFile